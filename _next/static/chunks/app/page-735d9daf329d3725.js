(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1793:function(e,n,r){Promise.resolve().then(r.bind(r,4343)),Promise.resolve().then(r.bind(r,5162))},4343:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return y}});var t=r(6093),s=r(3827),o=r(4090),a=r(3941);let c="http://localhost:3000",i={spreadsheets:"".concat(c,"/api/spreadsheets"),spreadsheetData:e=>"".concat(c,"/api/spreadsheet-data?id=").concat(e)};function d(){let e=(0,t._)(["\n  max-width: 1200px;\n  margin: 2rem auto;\n  padding: 2rem;\n  background: rgba(255, 255, 255, 0.9);\n  border-radius: 15px;\n  box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);\n  backdrop-filter: blur(4px);\n  overflow-x: auto;\n"]);return d=function(){return e},e}function l(){let e=(0,t._)(["\n  width: 100%;\n  padding: 1rem;\n  margin-bottom: 2rem;\n  border: 2px solid #e0e0e0;\n  border-radius: 8px;\n  font-size: 1rem;\n  background: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    border-color: #3f51b5;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #3f51b5;\n    box-shadow: 0 0 0 2px rgba(63, 81, 181, 0.2);\n  }\n"]);return l=function(){return e},e}function u(){let e=(0,t._)(["\n  width: 100%;\n  border-collapse: separate;\n  border-spacing: 0;\n  background: white;\n  border-radius: 10px;\n  overflow: hidden;\n"]);return u=function(){return e},e}function h(){let e=(0,t._)(["\n  background: #3f51b5;\n  color: white;\n  padding: 1rem;\n  text-align: left;\n  font-weight: 600;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n\n  &:first-child {\n    border-top-left-radius: 10px;\n  }\n\n  &:last-child {\n    border-top-right-radius: 10px;\n  }\n"]);return h=function(){return e},e}function f(){let e=(0,t._)(["\n  padding: 1rem;\n  border-bottom: 1px solid #eee;\n  color: #333;\n"]);return f=function(){return e},e}function p(){let e=(0,t._)(["\n  transition: background-color 0.3s ease;\n\n  &:hover {\n    background-color: #f5f5f5;\n  }\n\n  &:last-child td {\n    border-bottom: none;\n  }\n"]);return p=function(){return e},e}function x(){let e=(0,t._)(["\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  border: 3px solid rgba(0, 0, 0, 0.1);\n  border-radius: 50%;\n  border-top-color: #3f51b5;\n  animation: spin 1s ease-in-out infinite;\n  margin: 2rem auto;\n\n  @keyframes spin {\n    to {\n      transform: rotate(360deg);\n    }\n  }\n"]);return x=function(){return e},e}function b(){let e=(0,t._)(["\n  color: #ff4444;\n  background: #ffe6e6;\n  padding: 1rem;\n  border-radius: 8px;\n  margin: 1rem 0;\n  border: 1px solid #ffcccc;\n"]);return b=function(){return e},e}let m=a.ZP.div(d()),g=a.ZP.select(l()),_=a.ZP.table(u()),j=a.ZP.th(h()),v=a.ZP.td(f()),w=a.ZP.tr(p()),k=a.ZP.div(x()),S=a.ZP.div(b());var y=()=>{let[e,n]=(0,o.useState)([]),[r,t]=(0,o.useState)(""),[a,c]=(0,o.useState)([]),[d,l]=(0,o.useState)(!0),[u,h]=(0,o.useState)("");(0,o.useEffect)(()=>{f()},[]);let f=async()=>{try{h("");let e=await fetch(i.spreadsheets),r=await e.json();if(r.error)throw Error(r.details||r.error);n(r)}catch(e){console.error("Error fetching spreadsheets:",e),h(e instanceof Error?e.message:"Failed to fetch spreadsheets")}finally{l(!1)}},p=async e=>{l(!0),h("");try{let n=await fetch(i.spreadsheetData(e)),r=await n.json();if(r.error)throw Error(r.details||r.error);let t=r.map(e=>({store_name:e["Store Name"].split("-")[0].trim(),keyword:e.Keyword,scroll_success:parseInt(e["scroll (Success)"])||0,alarm_success:parseInt(e["alarm (Success)"])||0,save_place_success:parseInt(e["save_place (Success)"])||0,save_keep_success:parseInt(e["save_keep (Success)"])||0,feed_success:parseInt(e["feed (Success)"])||0}));c(t)}catch(e){console.error("Error fetching data:",e),h(e instanceof Error?e.message:"Failed to fetch spreadsheet data")}finally{l(!1)}};return(0,s.jsxs)(m,{children:[(0,s.jsxs)(g,{value:r,onChange:e=>{let n=e.target.value;t(n),n?p(n):c([])},children:[(0,s.jsx)("option",{value:"",children:"Select a spreadsheet"}),e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),u&&(0,s.jsx)(S,{children:u}),d?(0,s.jsx)(k,{}):a.length>0?(0,s.jsxs)(_,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)(j,{children:"Store Name"}),(0,s.jsx)(j,{children:"Keyword"}),(0,s.jsx)(j,{children:"Scroll Success"}),(0,s.jsx)(j,{children:"Alarm Success"}),(0,s.jsx)(j,{children:"Save Place Success"}),(0,s.jsx)(j,{children:"Save Keep Success"}),(0,s.jsx)(j,{children:"Feed Success"})]})}),(0,s.jsx)("tbody",{children:a.map((e,n)=>(0,s.jsxs)(w,{children:[(0,s.jsx)(v,{children:e.store_name}),(0,s.jsx)(v,{children:e.keyword}),(0,s.jsx)(v,{children:e.scroll_success}),(0,s.jsx)(v,{children:e.alarm_success}),(0,s.jsx)(v,{children:e.save_place_success}),(0,s.jsx)(v,{children:e.save_keep_success}),(0,s.jsx)(v,{children:e.feed_success})]},n))})]}):(0,s.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#666"},children:r?"No data available":"Please select a spreadsheet"})]})}},5162:function(e,n,r){"use strict";r.r(n);var t=r(6093),s=r(3827),o=r(3941);function a(){let e=(0,t._)(["\n  min-height: 100vh;\n  background: linear-gradient(135deg, #6e8efb 0%, #a777e3 100%);\n  padding: 2rem;\n"]);return a=function(){return e},e}function c(){let e=(0,t._)(["\n  color: white;\n  text-align: center;\n  font-size: 2.5rem;\n  margin-bottom: 2rem;\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\n"]);return c=function(){return e},e}let i=o.ZP.div(a()),d=o.ZP.h1(c());n.default=e=>{let{children:n}=e;return(0,s.jsxs)(i,{children:[(0,s.jsx)(d,{children:"Dashboard"}),n]})}},6093:function(e,n,r){"use strict";function t(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}r.d(n,{_:function(){return t}})}},function(e){e.O(0,[941,971,69,744],function(){return e(e.s=1793)}),_N_E=e.O()}]);